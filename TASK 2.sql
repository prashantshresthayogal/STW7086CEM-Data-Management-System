
-- CREATING THE DEPARTMENT TABLE
CREATE TABLE DEPARTMENT (
  DEPTID VARCHAR(3) NOT NULL CONSTRAINT DEPT_PK  PRIMARY KEY,
  NAME VARCHAR(50) NOT NULL
);

-- CREATING THE SALARYGRADE TABLE
CREATE TABLE SALARYGRADE (
  SALARYCODE VARCHAR(2) NOT NULL CONSTRAINT SALGRED_PK  PRIMARY KEY,
  STARTSALARY INT NOT NULL,
  FINISHSALARY INT NOT NULL
);


-- CREATING THE PENSIONSCHEME TABLE
CREATE TABLE PENSIONSCHEME (
  SCHEMEID VARCHAR(4) NOT NULL CONSTRAINT PENSION_PK  PRIMARY KEY,
  NAME VARCHAR(50) NOT NULL,
  RATE FLOAT NOT NULL

);

-- CREATING THE EMPLOYEE TABLE
CREATE  TABLE EMPLOYEE (
  EMPID VARCHAR(4) NOT NULL  CONSTRAINT EMP_PK  PRIMARY KEY,
  NAME VARCHAR(50) NOT NULL,
  ADDRESS VARCHAR(100) NOT NULL,
  DOB DATE NOT NULL,
  JOB VARCHAR(50) NOT NULL,
  SALARYCODE VARCHAR(2) NOT NULL,
  DEPTID VARCHAR(3) NOT NULL,
  MANAGER VARCHAR(4),
  SCHEMEID VARCHAR(4),
  CONSTRAINT DEPT_FK FOREIGN KEY (DEPTID) REFERENCES DEPARTMENT(DEPTID),
  CONSTRAINT PENSION_FK FOREIGN KEY (SCHEMEID) REFERENCES PENSIONSCHEME(SCHEMEID),
 CONSTRAINT SALARY_FK FOREIGN KEY (SALARYCODE) REFERENCES SALARYGRADE(SALARYCODE)
);



  --Insert data into Department table
INSERT INTO Department (DeptID, Name) VALUES  ('D10', 'Administration');
INSERT INTO Department (DeptID, Name) VALUES  ('D20', 'Finance');
INSERT INTO Department (DeptID, Name) VALUES  ('D30', 'Sales');
INSERT INTO Department (DeptID, Name) VALUES  ('D40', 'Maintenance');
INSERT INTO Department (DeptID, Name) VALUES  ('D50', 'IT Support');

SELECT * FROM Department;

--Insert data into SalaryGrade table
INSERT INTO SalaryGrade (SalaryCode, StartSalary, FinishSalary) VALUES ('S1', 15000, 18000);
INSERT INTO SalaryGrade (SalaryCode, StartSalary, FinishSalary) VALUES ('S2', 18001, 22000);
INSERT INTO SalaryGrade (SalaryCode, StartSalary, FinishSalary) VALUES ('S3', 22001, 25000);
INSERT INTO SalaryGrade (SalaryCode, StartSalary, FinishSalary) VALUES ('S4', 25001, 29000);
INSERT INTO SalaryGrade (SalaryCode, StartSalary, FinishSalary) VALUES ('S5', 29001, 38000);

--Insert data into PensionScheme table
INSERT INTO PensionScheme (SchemeID, Name, Rate) VALUES ('S110', 'AXA', 0.5);
INSERT INTO PensionScheme (SchemeID, Name, Rate) VALUES ('S121', 'Premier', 0.6);
INSERT INTO PensionScheme (SchemeID, Name, Rate) VALUES ('S124', 'Stakeholder', 0.4);
INSERT INTO PensionScheme (SchemeID, Name, Rate) VALUES ('S116', 'Standard', 0.4);


--Insert data into Employee table
INSERT INTO Employee VALUES  ('E101', 'Young, S.', '199 London Road',TO_DATE( '1976-03-05','YYYY-MM-DD'), 'Clerk', 'S1', 'D10', 'E110', 'S116');
INSERT INTO Employee VALUES  ('E301', 'April, H.', '20 Glade close',TO_DATE( '1979-03-10','YYYY-MM-DD'), 'Sales Person', 'S2', 'D30', 'E310', 'S124');
INSERT INTO Employee VALUES  ('E310', 'Newgate, E.', '10 Heap Street', TO_DATE('1980-11-28','YYYY-MM-DD'), 'Manager', 'S5', 'D30', NULL, 'S121');
INSERT INTO Employee VALUES  ('E501', 'Teach, E.', '22 railway road', TO_DATE('1972-02-12', 'YYYY-MM-DD'), 'Analyst', 'S5', 'D50', NULL, 'S121');
INSERT INTO Employee VALUES  ('E102', 'Hawkins, M.', '3 High Street', TO_DATE('1974-07-13', 'YYYY-MM-DD'), 'Clerk', 'S1', 'D10', 'E110', 'S116');
INSERT INTO Employee VALUES  ('E110', 'Watkins, J.', '11 crescent road', TO_DATE('1969-06-25','YYYY-MM-DD'), 'Manager', 'S5', 'D10', NULL, 'S121');




2A.
SELECT E.NAME, S.STARTSALARY, E.DEPTID
FROM EMPLOYEE E
INNER JOIN SALARYGRADE S
ON E.SALARYCODE = S.SALARYCODE
ORDER BY E.NAME ASC, E.DEPTID DESC;

2B.
SELECT PS.NAME, COUNT(E.SCHEMEID) AS NUMOFEMPLOYEES
FROM PENSIONSCHEME PS
LEFT JOIN EMPLOYEE E
ON PS.SCHEMEID = E.SCHEMEID
GROUP BY PS.NAME;

2C.
SELECT COUNT(*) AS NUMOFEMPLOYEES
FROM EMPLOYEE E
INNER JOIN SALARYGRADE S
ON E.SALARYCODE = S.SALARYCODE
WHERE E.JOB <> 'MANAGER' AND S.FINISHSALARY > 35000;


2D.
SELECT E.EMPID, E.NAME AS EMPLOYEENAME, M.NAME AS MANAGERNAME
FROM EMPLOYEE E
INNER JOIN EMPLOYEE M
ON E.MANAGER = M.EMPID;
